const fs = require('fs');

//Google Spreadsheet
const { GoogleSpreadsheet } = require('google-spreadsheet');
const { JWT } = require ('google-auth-library');

const googleCreds = JSON.parse(fs.readFileSync('./database/ciceroKey.json'));

const googleAuth = new JWT({
  // env var values here are copied from service account credentials generated by google
  // see "Authentication" section in docs for more info
  email: googleCreds.client_email,
  key: googleCreds.private_key,
  scopes: ['https://www.googleapis.com/auth/spreadsheets'],
});


module.exports = {

    newSheet: async function newSheet(sheetName, filesID){

        const doc = new GoogleSpreadsheet(filesID, googleAuth);
        const newSheet = await doc.addSheet({ title: sheetName });
    
    },

    postData: async function postData(data, sheetName, filesID){
      const doc = new GoogleSpreadsheet(filesID, googleAuth);
    },

    loadData: async function loadData(sheetName, filesID){
      const doc = new GoogleSpreadsheet(filesID, googleAuth);
    }
        
  };