const fs = require('fs');

//Google Spreadsheet
const { GoogleSpreadsheet } = require('google-spreadsheet');
const { JWT } = require ('google-auth-library');
const { title } = require('process');

const googleCreds = JSON.parse(fs.readFileSync('./database/ciceroKey.json'));

const googleAuth = new JWT({
  // env var values here are copied from service account credentials generated by google
  // see "Authentication" section in docs for more info
  email: googleCreds.client_email,
  key: googleCreds.private_key,
  scopes: ['https://www.googleapis.com/auth/spreadsheets'],
});


module.exports = {

    newClient: async function newClient(sheetName, sourceID, filesID){

      const sourceX = sourceID.split('/').pop();
      
      const targetDoc = new GoogleSpreadsheet(filesID, googleAuth);
      const targetSheet = await targetDoc.addSheet({ title: sheetName, headerValues:['ID_KEY', 'NAMA', 'DIVISI', 'JABATAN', 'STATUS', 'WHATSAPP', 'INSTA', 'TIKTOK'] });
     
      const sourceDoc = new GoogleSpreadsheet(sourceX, googleAuth);
      await sourceDoc.loadInfo(); // loads document properties and worksheets
      console.log(sourceDoc.title);

    }       
  };