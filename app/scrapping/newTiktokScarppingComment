import { tiktokCommentAPI } from "../socialMediaAPI/tiktokAPI.js";

export async function getLikesTiktok(todayItems, cursor_number) {
    let newDataUsers = [];
    let has_more = 0;
    let cursor_number = 0;
    
    tiktokCommentAPI(todayItems, cursor_number).then ( responseComments =>{

        setTimeout(() => {

            let commentItems = responseComments.data.comments;
            for (let ii = 0; ii < commentItems.length; ii++) {
                if (commentItems[ii].user.unique_id != undefined || commentItems[ii].user.unique_id != null || commentItems[i].user.unique_id != "") {
                    if (!newDataUsers.includes(commentItems[i].user.unique_id)) {
                        newDataUsers.push(commentItems[i].user.unique_id);
                    }
                }
            }

            has_more = responseComments.data.has_more;
            cursor_number = responseComments.data.cursor;

        }, 2000);
                
        if (has_more === 1){    

            getLikesTiktok(todayItems, cursor_number);

        } else {

            let data = {
                code : 200,
                status : true,
                newDataUsers : newDataUsers
            }
            
            return data;
        }

    }). catch (response => {
        console.log(response);

        let data = {
            code : 204,
            status : false,
            newDataUsers : null

        }
        return data;    
    });
}